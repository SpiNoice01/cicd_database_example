name: CICD Pipeline Dev To Production

on:
    push:
    branches:
        - main

jobs:
    db_cicd:
    name: Database CICD
    runs-on: ubuntu-latest

    steps:
        - name: Checkout
            uses: actions/checkout@v4.2.2 # Mengambil kode dari repositori

        - name: SSH Action
            uses: appleboy/ssh-action@v0.1.6 # Digunakan untuk mengeksekusi perintah SSH
            with:
                host: ${{ secrets.HOST }}
                username: ${{ secrets.USERNAME }}
                password: ${{ secrets.PASSWORD }}
                # Uncomment the following line if a custom port is required
                # port: 22
            script: |
                echo "Deploying to production server..."
                # Add your deployment commands here
                cd /path/to/your/project
                git pull origin main
                docker-compose down
                docker-compose up -d --build

        - name: Notify Deployment Success
            run: echo "Deployment to production server completed successfully."
